"use strict";(globalThis["webpackChunkweb"]=globalThis["webpackChunkweb"]||[]).push([[538],{4538:(e,a,l)=>{l.r(a),l.d(a,{default:()=>fe});l(8367);var t=l(9835),n=l(6970),i=l(499),o=l(1569),s=l(6827);const u=e=>s.Z.create({type:"negative",message:e,position:"top",timeout:3e3});async function c(){try{const{data:e}=await o.api.get("/machines");return e}catch(e){return u(e.message),e.message}}async function d(e){try{const{data:a}=await o.api.get(`/machines/${e}`);return a}catch(a){return u(a.message),a.message}}var m=l(9302),r=l(4376);const p={all:"primary",idle:"cyan",running:"blue",finished:"positive",errored:"red",repaired:"warning"},v={idle:"mode_standby",running:"loop",finished:"check_circle_outline",errored:"priority_high",repaired:"construction"},w={class:"q-pa-sm full-width full-height"},f={class:"flex full-width justify-between items-center"},g={class:""},_={__name:"TableForMachines",emits:["selectMachine"],setup(e,{emit:a}){const l=[{name:"id",label:"ID",align:"left",field:e=>e.id,format:e=>`${e}`,sortable:!0},{name:"status",label:"Status",align:"left",field:e=>e.status,sortable:!0},{name:"machine_type",label:"Type",align:"left",field:e=>e.machine_type,sortable:!1},{name:"floor",label:"Floor",align:"left",field:e=>e.floor,sortable:!0},{name:"install_date",label:"Install Date",align:"left",field:e=>e.install_date,sortable:!0},{name:"last_maintenance",label:"Last Maintenance",align:"left",field:e=>e.last_maintenance,format:e=>r.ZP.formatDate(e,"YYYY-MM-DD HH:mm:ss"),sortable:!1},{name:"location",label:"Location",align:"left",field:e=>e.location,format:e=>e,sortable:!1}],o=["all","idle","running","finished","errored"],s=((0,m.Z)(),(0,i.iH)([])),u=(0,i.iH)(!1),d=(0,i.iH)(""),v=(0,i.iH)("all"),_=(0,i.iH)("all"),b=(0,t.Fl)((()=>"all"==v.value?h():"all"==_.value?y():W));function h(){return"all"===_.value?s.value:s.value.filter((e=>e.status===_.value))}function y(){return"all"===v.value?s.value:s.value.filter((e=>e.machine_type===v.value))}function W(){return s.value.filter((e=>e.machine_type===v.value&&e.status===_.value))}async function q(){const e=await c(),{data:a}=e;console.log(e),s.value=a.map((e=>({...e,location:`longitude: ${e.longitude}/latitude: ${e.latitude}`}))),u.value=!1}function Z(e,l,t){a("selectMachine",l)}return(0,t.bv)((()=>{u.value=!0,q()})),(e,a)=>{const s=(0,t.up)("q-radio"),c=(0,t.up)("q-space"),m=(0,t.up)("q-select"),r=(0,t.up)("q-icon"),h=(0,t.up)("q-input"),y=(0,t.up)("q-badge"),W=(0,t.up)("q-td"),q=(0,t.up)("q-inner-loading"),Q=(0,t.up)("q-table"),k=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(k,{class:"full-width full-height"},{default:(0,t.w5)((()=>[(0,t._)("div",w,[(0,t.Wm)(Q,{title:"Machine List",rows:(0,i.SU)(b),columns:l,"row-key":"time",loading:u.value,"rows-per-page-options":[10,20],filter:d.value,style:{height:"87vh"},"virtual-scroll":"",onRowClick:Z},{top:(0,t.w5)((()=>[(0,t._)("div",f,[(0,t._)("div",g,[(0,t.Wm)(s,{modelValue:v.value,"onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e),val:"all",label:"All Type"},null,8,["modelValue"]),(0,t.Wm)(s,{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),val:"measurement",label:"Measurement"},null,8,["modelValue"]),(0,t.Wm)(s,{modelValue:v.value,"onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),val:"microscope",label:"Microscope"},null,8,["modelValue"])]),(0,t.Wm)(c),(0,t.Wm)(m,{"bg-color":(0,i.SU)(p)[_.value],outlined:"","hide-bottom-space":"",dense:"",modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value=e),options:o,style:{"min-width":"150px"}},null,8,["bg-color","modelValue"]),(0,t.Wm)(c),(0,t.Wm)(h,{dense:"",placeholder:"Search machine id",debounce:"300",color:"primary",modelValue:d.value,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value=e)},{append:(0,t.w5)((()=>[(0,t.Wm)(r,{name:"search"})])),_:1},8,["modelValue"])])])),"body-cell-status":(0,t.w5)((e=>[(0,t.Wm)(W,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{color:(0,i.SU)(p)[e.value],label:e.value},null,8,["color","label"])])),_:2},1032,["props"])])),"body-cell-location":(0,t.w5)((e=>[(0,t.Wm)(W,{props:e,class:"vertical-middle"},{default:(0,t.w5)((()=>[(0,t._)("div",null,(0,n.zw)(e.value.split("/")[0]),1),(0,t._)("div",null,(0,n.zw)(e.value.split("/")[1]),1)])),_:2},1032,["props"])])),loading:(0,t.w5)((()=>[(0,t.Wm)(q,{showing:"",color:"primary"})])),_:1},8,["rows","loading","filter"])])])),_:1})}}};var b=l(9885),h=l(1971),y=l(1480),W=l(136),q=l(2233),Z=l(6611),Q=l(2857),k=l(7220),H=l(990),U=l(854),S=l(9984),M=l.n(S);const x=_,D=x;M()(_,"components",{QPage:b.Z,QTable:h.Z,QRadio:y.Z,QSpace:W.Z,QSelect:q.Z,QInput:Z.Z,QIcon:Q.Z,QTd:k.Z,QBadge:H.Z,QInnerLoading:U.Z});const V="ws://codingcase.zeiss.services/ws";function z(){let e=(0,i.iH)(null);const a=(0,i.iH)({}),l=(0,i.iH)([]);return(0,t.bv)((()=>{e.value=new WebSocket(V),e.value.onopen=e=>{},e.value.onmessage=e=>{const{data:t}=e;if(t){const e=Object.assign(JSON.parse(t),{});a.value=e.payload,l.value.push(e.payload),console.log(a.value)}}})),(0,t.Ah)((()=>{e.value.close(),e.value=null})),{client:e,wsData:a,wsHistory:l}}const Y=e=>((0,t.dD)("data-v-d7ef32d2"),e=e(),(0,t.Cn)(),e),I={class:"container row"},T={class:"col-7"},j={class:"col q-ma-sm"},L={class:"col-7 q-px-lg"},P={class:"text-overline"},C={class:"text-h5 q-mt-sm q-mb-xs"},A={class:"text-caption text-grey"},N={class:"row no-wrap items-end q-ml-auto"},$=Y((()=>(0,t._)("div",{class:"col text-h6 ellipsis"}," ",-1))),F={class:"col-auto text-dard text-caption q-pt-md row no-wrap items-center"},R=Y((()=>(0,t._)("div",{class:"text-subtitle1"},"$・Specific Information",-1))),B=Y((()=>(0,t._)("div",{class:"text-caption text-grey"}," Switch tab to get real time information or machine events list ",-1))),O=(0,t.Uk)("Machine ID"),E=(0,t.Uk)("Status"),G=(0,t.Uk)("Message ID"),J=(0,t.Uk)("Coming WS Message:"),K={__name:"IndexPage",setup(e){const a={measurement:"https://5.imimg.com/data5/HU/TG/MY-8481510/spectrum-coordinate-measuring-machine-250x250.jpg",microscope:"https://www.zeiss.de/mikroskopie/produkte/stereo-zoom-microscopes/j/m/productmetadata_648b/imageTI.mobile.980.jpg/1454666378391.jpg/axiozoom-optical-inspection.jpg"},l=[{name:"timestamp",label:"Timestamp",align:"left",field:e=>e.timestamp,format:e=>r.ZP.formatDate(e,"YYYY-MM-DD HH:mm:ss"),sortable:!1},{name:"status",label:"Status",align:"left",field:e=>e.status,sortable:!1}],o=(0,i.iH)("one"),s=(0,i.iH)(!1),u=(0,i.iH)({}),c=(0,i.iH)([]),m=(0,i.iH)({});function w(){}async function f(e){s.value=!0,u.value=e;const{data:a}=await d(e.id);a&&g(a),s.value=!1}async function g(e){u.value=e,c.value=e.events,h()}const{wsHistory:_,wsData:b}=z();function h(){const e=u.value.id,a=_.value.findLast((a=>a.machine_id==e));a&&(m.value=a)}return(0,t.YP)(b,(()=>{var e;b.value.machine_id===(null===(e=u.value)||void 0===e?void 0:e.id)&&(m.value=b.value,u.value.status=b.value.status)}),{deep:!0}),(0,t.bv)((()=>{w()})),(e,d)=>{const w=(0,t.up)("q-img"),g=(0,t.up)("q-card-section"),_=(0,t.up)("q-btn"),h=(0,t.up)("q-separator"),y=(0,t.up)("q-tab"),W=(0,t.up)("q-tabs"),q=(0,t.up)("q-item-label"),Z=(0,t.up)("q-item-section"),Q=(0,t.up)("q-item"),k=(0,t.up)("q-list"),H=(0,t.up)("q-tab-panel"),U=(0,t.up)("q-table"),S=(0,t.up)("q-tab-panels"),M=(0,t.up)("q-spinner-tail"),x=(0,t.up)("q-inner-loading"),V=(0,t.up)("q-card"),z=(0,t.up)("q-page"),Y=(0,t.Q2)("ripple");return(0,t.wg)(),(0,t.j4)(z,{class:"q-pa-sm"},{default:(0,t.w5)((()=>[(0,t._)("div",I,[(0,t._)("div",T,[(0,t.Wm)(D,{onSelectMachine:f})]),(0,t._)("div",j,[(0,t.Wm)(V,{class:"my-card relative-position",style:{height:"87vh"}},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{class:"row"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{src:a[u.value.machine_type],height:"200px",class:"col"},null,8,["src"]),(0,t._)("div",L,[(0,t._)("div",P,(0,n.zw)(u.value.id||"Machine ID"),1),(0,t._)("div",C,(0,n.zw)(u.value.machine_type||"Machine Type"),1),(0,t._)("div",A,[(0,t._)("div",null,"Floor: "+(0,n.zw)(u.value.floor||"-"),1),(0,t._)("div",null," Install Date: "+(0,n.zw)(u.value.install_date||"-"),1),(0,t._)("div",null," Last Maintenance: "+(0,n.zw)(u.value.last_maintenance?(0,i.SU)(r.ZP).formatDate(u.value.last_maintenance,"YYYY-MM-DD HH:mm:ss"):"-"),1),(0,t._)("div",null,"Longitude: "+(0,n.zw)(u.value.longitude||"-"),1),(0,t._)("div",null,"Latitude: "+(0,n.zw)(u.value.latitude||"-"),1)])])])),_:1}),(0,t.Wm)(g,{class:"row"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{fab:"",color:(0,i.SU)(p)[u.value.status]||"primary",icon:(0,i.SU)(v)[u.value.status]||"mode_standby",class:"absolute",style:{top:"0",right:"12px",transform:"translateY(-50%)"}},null,8,["color","icon"]),(0,t._)("div",N,[$,(0,t._)("div",F,(0,n.zw)(u.value.status),1)])])),_:1}),(0,t.Wm)(g,{class:"q-pt-none"},{default:(0,t.w5)((()=>[R,B])),_:1}),(0,t.Wm)(h),(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=e=>o.value=e),class:"text-teal"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{label:"Real Time Info",name:"one"}),(0,t.Wm)(y,{label:"Events List",name:"two"})])),_:1},8,["modelValue"]),(0,t.Wm)(S,{modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=e=>o.value=e),animated:""},{default:(0,t.w5)((()=>[(0,t.Wm)(H,{name:"one"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{bordered:"",separator:""},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{overline:""},{default:(0,t.w5)((()=>[O])),_:1}),(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(m.value.machine_id||"N/A"),1)])),_:1})])),_:1})])),_:1})),[[Y]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Timestamp: "+(0,n.zw)(m.value.timestamp?(0,i.SU)(r.ZP).formatDate(m.value.timestamp,"YYYY-MM-DD HH:mm:ss"):"N/A"),1)])),_:1})])),_:1})),[[Y]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[E])),_:1}),(0,t.Wm)(q,{caption:""},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(m.value.status||"N/A"),1)])),_:1})])),_:1})])),_:1})),[[Y]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{overline:""},{default:(0,t.w5)((()=>[G])),_:1}),(0,t.Wm)(q,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(m.value.id||"N/A"),1)])),_:1})])),_:1})])),_:1})),[[Y]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(Q,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(Z,null,{default:(0,t.w5)((()=>[(0,t.Wm)(q,{overline:""},{default:(0,t.w5)((()=>[J])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,i.SU)(b),(e=>((0,t.wg)(),(0,t.j4)(q,{caption:"",key:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,n.zw)(e),1)])),_:2},1024)))),128))])),_:1})])),_:1})),[[Y]])])),_:1})])),_:1}),(0,t.Wm)(H,{name:"two"},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{dense:"",flat:"",style:{height:"37vh"},rows:c.value,columns:l,"row-key":"index","virtual-scroll":"","rows-per-page-options":[0]},{top:(0,t.w5)((()=>[])),_:1},8,["rows"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(x,{showing:s.value},{default:(0,t.w5)((()=>[(0,t.Wm)(M,{size:"50px",color:"primary"})])),_:1},8,["showing"])])),_:1})])])])),_:1})}}};var X=l(1639),ee=l(9892),ae=l(3190),le=l(335),te=l(9379),ne=l(926),ie=l(7817),oe=l(7661),se=l(9800),ue=l(4106),ce=l(3246),de=l(490),me=l(1233),re=l(3115),pe=l(261),ve=l(1136);const we=(0,X.Z)(K,[["__scopeId","data-v-d7ef32d2"]]),fe=we;M()(K,"components",{QPage:b.Z,QCard:ee.Z,QCardSection:ae.Z,QImg:le.Z,QBtn:te.Z,QSeparator:ne.Z,QTabs:ie.Z,QTab:oe.Z,QTabPanels:se.Z,QTabPanel:ue.Z,QList:ce.Z,QItem:de.Z,QItemSection:me.Z,QItemLabel:re.Z,QTable:h.Z,QInnerLoading:U.Z,QSpinnerTail:pe.Z}),M()(K,"directives",{Ripple:ve.Z})}}]);